lmc
# Отчет по выполненным заданиям.

Выполнили студенты группы Б8320:
Луценко А.Н.
Терещенко К.Г.
Ведюн И.В.


По результатам выполненных работ мы имеем 10 рабочих программ:

  - log_digits.py (Логистическая регрессия для набора чисел)
  - log_iris.py (Логистическая регрессия для ирисов)
  - log_reg_diabets.py (Логистическая регрессия для набора данных по диабету)
  - log_reg_rak.py (Логистическая регрессия для набора данных по раковым больным)
  - log_reg_titanic.py (Логистическая регрессия для набора данных по пассажирам Титаника)
  - svm diabets.py (Метод опорных векторов для набора данных по диабету)
  - svm iris.py (Метод опорных векторов для ирисов)
  - svm digits.py (Метод опорных векторов для набора чисел)
  - svm rak.py (Метод опорных векторов для набора данных по раковым больным)
  - svm titanic.py (Метод опорных векторов для набора данных по пассажирам Титаника)

# Описание кода для метода логистической регрессии

Для объяснения принципа работы метода логистической регерессии мы привели пример на программе log_reg_titanic.py. В других программах использующих данный метод меняется только блок выгрузки данных.

### Описание кода log_reg_titanic.py

```sh
import pandas as pd
from sklearn.linear_model import LogisticRegression
from cross_validation_plotter import plot_cross_validation
from sklearn.model_selection import cross_val_score

# Блок загрузки данных
data = pd.read_csv("titanic.csv", sep = ",")

data_notna = pd.DataFrame.dropna(data)

X = data_notna[["Pclass", "Fare", "Age", "Sex"]]
X.replace("male", 0, True, None, False)
X.replace("female", 1, True, None, False)

y = data_notna["Survived"]
#

clf = LogisticRegression(random_state=123, solver='lbfgs',
                         multi_class='multinomial',  max_iter=300)

clf.fit(X, y)

print("---------------------------------------")
print("Первые два объекта из X")
print(X.loc[:3, :])
print("Предсказание класса для первых двух объектов из X")
print(clf.predict(X.loc[:3, :]))
print("---------------------------------------")
print(cross_val_score(clf, X, y, cv=10))

# функция для построения графиков 
print("---------------------------------------")
help(plot_cross_validation) # 
print("---------------------------------------")
print("Вызов функции")
plot_cross_validation(X=X, y=y, clf=clf, title="Logistic Regression")
print("---------------------------------------")
```
Изначально, нужно подключить необходимые библиотеки и функции, которые будут задействованны в написании программы log_reg_titanic.py. Pandas нам потребуется для импорта данных по пассажирам Титаника из .csv файла. Из бибилиотеки sklearn модуль LogisticRegression, который является ключевым для рассчета данных. Далее, мы подключаем написанную функцию cross_validation_plotter, которая необходима для построения графиков. cross_val_score используется для оценки модели прогнозирования. 
Далее мы выгружаем данные и структуризируем их для дальнейшей работы. 
Мы назвали экземпляр нашего алгоритма оценки clf, так как он является классификатором. Теперь он должен быть применен к модели, т.е. он должен обучится на модели. Это осуществляется путем прогона нашей обучающей выборки через метод fit. 
Следом идет вывод полученных результатов.

# Описание кода для метода опорных векторов

Также, как и в предыдущем случае, для объяснения принципа работы метода опорных векторов мы привели пример на программе svm_iris.py. В других программах использующих данный метод меняется, также, только блок выгрузки данных.

### Описание кода svm_iris.py

```sh
from cross_validation_plotter import plot_cross_validation
from sklearn import svm, datasets
from sklearn.model_selection import cross_val_score


# импортируем набор данных (iris)
iris = datasets.load_iris()
X = iris.data[:, :2] # возьмём только первые 2 признака, чтобы проще воспринять вывод
y = iris.target

C = 1.0 # параметр регуляризации SVM
svc = svm.SVC(kernel='linear', C=1, gamma=0.1)
svc.fit(X, y)


print("---------------------------------------")
print("Предсказание класса для первых двух объектов из X")
print(svc.predict(X[:2, :]))
print("---------------------------------------")
print(cross_val_score(svc, X, y, cv=10))

# Забираем функцию для построения графиков
print("---------------------------------------")
help(plot_cross_validation) # 
print("---------------------------------------")
print("Вызов функции")
plot_cross_validation(X=X, y=y, clf=svc, title="SVM")
print("---------------------------------------")

```

Сперва, как и в прошлом примере, подключаем необходимые библиотеки. В отличии от программ, где мы используем данные по Титанику и диабетикам, данные для программы мы подключаем через метод datasets, который находится в библиотеке sklearn. svm используется для работы с методом опорных векторов. 
Далее, как и в примере с логистической регрессией у нас идет блок вызова метода опорных векторов и блок вывода результата работы программы.

# Время работы каждого из кодов
| Программа | Время работы |
| ------ | ------ |
| log_reg titanic | 0.72222222 |
| log_reg iris | 1 |
| log_reg digits | 0.93181818 |
| log_reg diabetes | 0.82894737 |
| log_reg rak | 0.91071429 |
| svm titanic | 0.91071429 |
| svm iris | 0.86666667 |
| svm digits | 0.96590909 |
| svm diabetes | 0.81578947 |
| svm rak | 0.91071429 |